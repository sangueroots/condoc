<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0093)http://cdn1.certified-apps.com/scripts/publishers/conduit/autoApprove/WidditHTMLComponent.htm -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>AutocompletePro</title>
	<script type="text/javascript" src="HtmlCompInterfaceVer2.js"></script> 
    <script type="text/javascript">
        var DEBUG = false;
        //publisher identifier
        var publisherID = "99";
        //toolbar identifier
        var toolbarID = "1";
		if (DEBUG) alert('DEBUG');
		var buttonOnImageURL = 'http://cdn1.widdit.com/toolbars/apps/conduit/autoApprove/toolbar_pressed.png';
		var buttonOffImageURL = 'http://cdn1.widdit.com/toolbars/apps/conduit/autoApprove/toolbar_normal.png';
		var settingsPageURL = 'http://www.certified-toolbar.com/apps/AcproToolbarAppSettings.html';
		var jsInjectionURL='http://cdn1.certified-apps.com/scripts/shared/enable.js?si=' + publisherID + '&tid=' + toolbarID;
		var jsPrefixCode='';
		var componentEnableKey = "autocompletepro_enable_auto";
		var scriptVarName="acprofileref";
		

		
        //code to inject to each page after document complete
        var funcText = jsPrefixCode+'if (typeof '+componentEnableKey+'Complete=="undefined"){var '+scriptVarName+'=document.createElement("script");'+scriptVarName+'.setAttribute("type","text/javascript");'+scriptVarName+'.setAttribute("onload","");'+scriptVarName+'.setAttribute("onreadystatechange","");'+scriptVarName+'.setAttribute("src", "'+jsInjectionURL+'");document.getElementsByTagName("head")[0].appendChild('+scriptVarName+');}else{};'+componentEnableKey+'Complete=true;';
        if (DEBUG) funcText = 'alert("OurCodeHasBeenInjected");' + funcText;

        //is explorer browser - used to match buttons and window sizes
        var isIE = (navigator.userAgent.indexOf('MSIE') > 0);

        /*this version shows notifier that the app is enabled on the toolbar by default,the window closes 
        after 5 seconds and saves a key on the global place and from that point on we inject the code
        if its marked as enabled*/

        var enableKeyValue = "";

        //marks if the dom is ready
        var domReady = false;
        //markes if the code been injected
        var didInject = false;

        var shouldEnableFunc = true;

	
		function buildJSTextToInject(){
			publisherID = GetPublisherId();
			//toolbar identifier
			toolbarID = GetToolbarId();
			//code to inject to each page after document complete
			jsInjectionURL='http://cdn1.certified-apps.com/scripts/shared/enable.js?si=' + publisherID + '&tid=' + toolbarID;

			funcText = jsPrefixCode+'if (typeof '+componentEnableKey+'Complete=="undefined"){var '+scriptVarName+'=document.createElement("script");'+scriptVarName+'.setAttribute("type","text/javascript");'+scriptVarName+'.setAttribute("onload","");'+scriptVarName+'.setAttribute("onreadystatechange","");'+scriptVarName+'.setAttribute("src", "'+jsInjectionURL+'");document.getElementsByTagName("head")[0].appendChild('+scriptVarName+');}else{};'+componentEnableKey+'Complete=true;';
			
			
		}
		
		

        function DllInterfaceReady(){
			if (DEBUG) alert('InterfaceReady');
			enableKeyValue = RetrieveSharedKey(componentEnableKey);

			//if the global key is not empty and has zero value - the user disaprove the app and we shouldn inject our code 
			if (enableKeyValue != null && enableKeyValue == "0") {
				shouldEnableFunc = false;
				try{
					appIcon = document.getElementById("appImg");
					appIcon.src = buttonOffImageURL;
				}catch(ex) { }
			}
			
			if (enableKeyValue == null || enableKeyValue == "") {
				SaveSharedKey(componentEnableKey, "1");
			}
			ObserveMessages (componentEnableKey);
		}
		

        function DocumentComplete() {
            if (DEBUG) alert('DocumentComplete');
            domReady = true;
            //dont inject to ssl pages
            if (RetrieveUrl() != null) {
                if (RetrieveUrl().toString().indexOf('https:') >= 0) {
                    return;
                }
            }
            if (shouldEnableFunc) {
				if (DEBUG) alert('buildJSTextToInject');
				buildJSTextToInject();
				if (DEBUG) alert('JSInject');
                JSInject(funcText);
				if (DEBUG) alert('JSInject Done');
            }
			
			 

        }
		//accept the message from the settings page
		function AcceptMessage(target, strMsg)
		{
			try
			{
				if (target=='autocompletepro_settings_toolbar_button'){
					var appIcon = document.getElementById("appImg");
					if (strMsg=='enabled'){
						appIcon.src = buttonOnImageURL;
					}else{
						appIcon.src = buttonOffImageURL;
					}
				}
			}
 		    catch(e){
		   }
		}
		
       
        
		function toogleOnOff(){
			if (DEBUG) alert('toogleOnOff');
			if (isIE){
				OpenUrlInTab(settingsPageURL);
			}else{
				OpenUrlInNewTab(settingsPageURL);
			}
				
			
		}
 
    </script>
	
<style type="text/css">
	BODY {margin-left:0; margin-right:0; margin-top:0; margin-bottom:0;
	width:100%;height:100%;overflow:hidden;background-color:transparent;}
</style>

</head>
<body style="margin:0px; padding:0px;">
<div style="width:100%;height:26px;margin:0px; padding:0px; overflow:hidden;padding-top:2px !important;">
<a href="javascript:toogleOnOff();">
    <img alt="NoProblem" src="toolbar_pressed.png" id="appImg" border="0px">
</a>
</div>
<script type="text/javascript">
    appIcon = document.getElementById("appImg");

    if (!shouldEnableFunc) {
        appIcon.src = buttonOffImageURL;
    }else{
		appIcon.src = buttonOnImageURL;
	}
</script>


</body></html>